| # | Опис | L1 | L2 | L3 | CWE |
|---|---|---|---|---|---|
| 13.1 | Переконайтеся, що всі компоненти програми використовують однакові кодування і парсери щоб уникнути синтаксичних атак, які використовують різні URI або поведінку синтаксичного аналізу файлів які можуть бути використані в SSRF та RFI-атаках. | ✓ | ✓ | ✓ | 116 |
| 13.2 | [ВИДАЛЕНО, ДУБЛЮЄ 4.3.1]. |  |  |  |  |
| 13.3 | Переконайтеся, що URL-адреси API не розкривають конфіденційну інформацію, таку як ключ API, токени сесій тощо. | ✓ | ✓ | ✓ | 598 |
| 13.4 | Переконайтеся, що рішення про авторизацію приймаються як на URI, так і на програмним або декларативним захистом на контролері або маршрутизаторі, так і на рівні ресурсів, що забезпечується дозволами на основі моделей. |  | ✓ | ✓ | 285 |
| 13.5 | Переконайтеся, що запити, що містять неочікувані або відсутні типи контенту відхиляються з відповідними заголовками (статус відповіді HTTP 406 Неприйнятно або 415 Unsupported Media Type). |||| 434 |

# CWE - 116

## Опис

Продукт отримує вхідні дані від попереднього компонента, але не обробляє або неправильно обробляє їх, коли відсутній очікуваний спеціальний елемент.

### Потенційні способи усунення

Розробники повинні передбачити, що спеціальні елементи будуть вилучені з вхідних векторів їхнього продукту. Використовуйте відповідну комбінацію денилістів і дозволів, щоб гарантувати, що система обробляє лише дійсні, очікувані та відповідні вхідні дані.

#### Етап: Впровадження

**Стратегія: Перевірка вхідних даних**

Припустіть, що всі вхідні дані є зловмисними. Використовуйте стратегію перевірки вхідних даних за принципом "прийняти відоме добре", тобто використовуйте список прийнятних вхідних даних, які строго відповідають специфікаціям. Відкидайте всі вхідні дані, які не відповідають специфікаціям, або перетворіть їх на такі, що відповідають специфікаціям.

Виконуючи перевірку вхідних даних, враховуйте всі потенційно важливі властивості, включаючи довжину, тип вхідних даних, повний діапазон допустимих значень, відсутні або зайві дані, синтаксис, узгодженість між пов'язаними полями і відповідність бізнес-правилам. Як приклад логіки бізнес-правил, "boat" може бути синтаксично правильним, оскільки містить лише алфавітно-цифрові символи, але не буде правильним, якщо очікується, що вхідні дані будуть містити лише кольори, наприклад, "червоний" або "синій".

Не покладайтеся виключно на пошук зловмисних або неправильно оформлених вхідних даних. Ймовірно, ви пропустите принаймні один небажаний вхід, особливо якщо середовище коду змінюється. Це може дати зловмисникам достатньо простору для того, щоб обійти заплановану перевірку. Однак денилізатори можуть бути корисними для виявлення потенційних атак або визначення того, які вхідні дані настільки неправильні, що їх слід одразу відкинути.

#### Етап: Впровадження

**Стратегія: Перевірка вхідних даних**

Перед перевіркою вхідні дані повинні бути розшифровані та канонізовані до поточного внутрішнього представлення програми (CWE-180). Переконайтеся, що програма не декодує ті самі вхідні дані двічі (CWE-174). Такі помилки можуть бути використані для обходу схем валідації списків дозволів шляхом введення небезпечних вхідних даних після того, як вони були перевірені.

# CWE - 598

## Опис

Веб-додаток використовує метод HTTP GET для обробки запиту і включає конфіденційну інформацію в рядок запиту.

### Розширений опис

Рядок запиту URL-адреси може зберігатися в історії браузера, передаватися через перенаправлення на інші веб-сайти, зберігатися у веб-журналах або іншим чином записуватися в інших джерелах. Якщо рядок запиту містить конфіденційну інформацію, наприклад, ідентифікатори сеансів, зловмисники можуть використовувати цю інформацію для подальших атак.

### Потенційні способи зменшення ризиків

#### Етап: Реалізація

Коли надсилається конфіденційна інформація, використовуйте метод POST (наприклад, реєстраційна форма).

#### Методи виявлення

- **Автоматизований статичний аналіз:** 
  - Автоматизований статичний аналіз, який зазвичай називають статичним тестуванням безпеки додатків (SAST), може виявити деякі приклади цієї вразливості, аналізуючи вихідний код (або двійковий чи скомпільований код) без необхідності його виконання. Зазвичай це робиться шляхом побудови моделі потоку даних і потоку управління, а потім пошуку потенційно вразливих шаблонів, які з'єднують "джерела" (джерела вхідних даних) з "стоками" (місцями призначення, де дані взаємодіють із зовнішніми компонентами, нижчим рівнем, таким як ОС тощо).
  - **Ефективність:** Висока


# CWE - 285

## Опис

Продукт не виконує або неправильно виконує перевірку авторизації, коли актор намагається отримати доступ до ресурсу або виконати дію.

### Розширений опис

Припускаючи, що користувач має певний ідентифікатор, авторизація - це процес визначення того, чи може цей користувач отримати доступ до певного ресурсу, на основі його привілеїв і будь-яких дозволів або інших специфікацій контролю доступу, які застосовуються до ресурсу.

Коли перевірки контролю доступу застосовуються непослідовно - або взагалі не застосовуються - користувачі можуть отримати доступ до даних або виконувати дії, які вони не повинні мати права виконувати. Це може призвести до широкого спектру проблем, включаючи витік інформації, відмову в обслуговуванні та довільне виконання коду.

### Альтернативні терміни

- **AuthZ:** "AuthZ" зазвичай використовується як абревіатура "авторизації" у спільноті розробників безпеки веб-додатків. Він відрізняється від "AuthN" (або, іноді, "AuthC"), який є абревіатурою "автентифікації". Використання "Auth" як абревіатури не рекомендується, оскільки вона може використовуватися як для автентифікації, так і для авторизації.

### Загальні відомості

Список контролю доступу (ACL) показує, хто/що має права на певний об'єкт. Різні операційні системи реалізують (ACL) по-різному. В UNIX існує три типи дозволів: читання, запис і виконання. Користувачі поділяються на три класи для доступу до файлів: власник, власник групи і всі інші користувачі, де кожен клас має окремий набір прав. У Windows NT існує чотири основних типи прав доступу до файлів: "Немає доступу", "Доступ на читання", "Змінити доступ" і "Повний контроль". Windows NT розширює концепцію трьох типів користувачів в UNIX, включаючи список користувачів і груп разом з відповідними дозволами. Користувач може створити об'єкт (файл) і призначити цьому об'єкту певні дозволи.

# CWE - 434

## Опис

Продукт дозволяє зловмиснику завантажувати або передавати файли небезпечних типів, які можуть бути автоматично оброблені в середовищі продукту.

### Альтернативні терміни

- **Необмежене завантаження файлів:** Використовується в базах даних вразливостей та інших джерелах, але є недостатньо точним. Фраза може бути інтерпретована як відсутність обмежень на розмір або кількість завантажених файлів, що є проблемою споживання ресурсів.
